<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pick Your Room ‚Äì Company Trip 2025 (with Admin Stats Page)</title>
<style>
  :root{ --accent:#c20000; --muted:#6b6b6b; --card:#fff; }
  body{ font-family:"Segoe UI",Roboto,Arial,sans-serif; background:#f3f4f6; margin:0; color:#222; }
  header{ display:flex; align-items:center; justify-content:center; gap:16px; background:white; padding:16px 20px; box-shadow:0 1px 4px rgba(0,0,0,0.06); position:sticky; top:0; z-index:10; }
  header .left{ position:absolute; left:20px; }
  header img{ height:48px; display:block; }
  header h1{ margin:0; color:var(--accent); font-size:22px; font-weight:700; }

  .controls{ max-width:1100px; margin:18px auto 0; display:flex; align-items:center; justify-content:space-between; gap:12px; padding:0 16px; }
  .stats{ font-size:15px; color:var(--muted); }
  button.primary{ background:var(--accent); color:white; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600; }
  button.ghost{ background:transparent; border:1px solid #ddd; padding:7px 10px; border-radius:8px; cursor:pointer; }

  .sections-wrap{ max-width:1100px; margin:18px auto 90px; display:grid; grid-template-columns:repeat(3,1fr); gap:18px; padding:0 16px; box-sizing:border-box; }
  .section{ background:white; border-radius:12px; padding:12px; box-shadow:0 6px 18px rgba(0,0,0,0.04); }
  .section .header{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:10px; }
  .section h2{ margin:0; color:var(--accent); font-size:16px; }
  .section .controls-inline{ display:flex; gap:8px; align-items:center; }

  .room-grid{ display:grid; grid-template-columns: repeat(auto-fill,minmax(140px,1fr)); gap:12px; }
  .room-card{ background:var(--card); border-radius:10px; padding:10px; box-shadow:0 6px 18px rgba(0,0,0,0.06); text-align:center; border:2px solid transparent; cursor:pointer; transition:transform .12s ease,border-color .12s; }
  .room-card:hover{ transform:translateY(-4px); border-color:#e6e6e6; }
  .room-card.locked{ opacity:0.75; cursor:not-allowed; border-color:#f4cccc; background:#fff6f6; }
  .room-icon{ font-size:34px; margin-bottom:6px; }
  .room-name{ font-weight:700; margin-bottom:6px; font-size:14px; color:#111; }
  .room-occupants{ font-size:13px; color:var(--muted); min-height:28px; line-height:1.2; }

  .modal{ display:none; position:fixed; inset:0; background:rgba(0,0,0,0.45); align-items:center; justify-content:center; z-index:50; padding:20px; }
  .modal.open{ display:flex; }
  .modal-panel{ width:360px; background:white; border-radius:12px; padding:18px; box-shadow:0 12px 36px rgba(0,0,0,0.18); text-align:left; }
  .modal-panel h3{ margin:0 0 12px; font-size:18px; color:#222; text-align:center; }
  .modal-panel .sub{ font-size:13px; color:var(--muted); text-align:center; margin-bottom:12px; }
  .input{ width:100%; box-sizing:border-box; padding:10px 12px; border-radius:8px; border:1px solid #dcdcdc; font-size:15px; margin-bottom:14px; outline:none; }
  .row{ display:flex; gap:10px; }
  .row .btn{ flex:1; padding:10px 12px; border-radius:8px; border:none; cursor:pointer; font-weight:700; }
  .btn.register{ background:var(--accent); color:white; }
  .btn.close{ background:#f0f0f0; color:#333; }

  .occupant-list{ margin-bottom:12px; }
  .occupant-item{ background:#fafafa; border:1px solid #eee; padding:8px 10px; border-radius:8px; margin-bottom:8px; display:flex; justify-content:space-between; align-items:center; font-size:14px; }
  .occupant-item button{ border:none; background:transparent; color:#c00; cursor:pointer; font-weight:700; }

  .stats-page{ display:none; max-width:1100px; margin:40px auto; background:white; border-radius:12px; padding:20px; box-shadow:0 6px 20px rgba(0,0,0,0.08); }
  .stats-page table{ width:100%; border-collapse:collapse; margin-top:16px; }
  .stats-page th, .stats-page td{ border:1px solid #ddd; padding:8px; text-align:left; }
  .stats-page th{ background:#f8f8f8; }
  .back-btn{ margin-top:20px; background:#333; color:white; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; }
  @media (max-width:980px){ .sections-wrap{ grid-template-columns:1fr; } }
</style>
</head>
<body>

<header>
  <div class="left"><img src="c054929f-e7b4-4cf9-9ee4-0eb99611c227.png" alt="ARUP" /></div>
  <h1>Pick Your Room ‚Äì Company Trip 2025</h1>
</header>

<div class="controls" id="main-controls">
  <div class="stats" id="summaryLeft"><span id="totalInfo">Loading...</span></div>
  <div class="right">
    <button class="ghost" id="exportCsvBtn">Export CSV</button>
    <button class="primary" id="openAdmin">Admin</button>
  </div>
</div>

<!-- Main content -->
<div class="sections-wrap" id="main-page">
  <div class="section" id="section-single">
    <div class="header"><h2>Single Rooms</h2>
      <div class="controls-inline">
        <button class="ghost admin-only" id="single-remove">‚àí Remove Room</button>
        <button class="ghost" id="single-add">Ôºã Add Room</button>
      </div>
    </div>
    <div class="room-grid" id="grid-single"></div>
  </div>

  <div class="section" id="section-double">
    <div class="header"><h2>Double Rooms</h2>
      <div class="controls-inline">
        <button class="ghost admin-only" id="double-remove">‚àí Remove Room</button>
        <button class="ghost" id="double-add">Ôºã Add Room</button>
      </div>
    </div>
    <div class="room-grid" id="grid-double"></div>
  </div>

  <div class="section" id="section-triple">
    <div class="header"><h2>Triple Rooms</h2>
      <div class="controls-inline">
        <button class="ghost admin-only" id="triple-remove">‚àí Remove Room</button>
        <button class="ghost" id="triple-add">Ôºã Add Room</button>
      </div>
    </div>
    <div class="room-grid" id="grid-triple"></div>
  </div>
</div>

<!-- Stats Page -->
<div class="stats-page" id="stats-page">
  <h2>üìä Room Statistics</h2>
  <div id="stats-summary"></div>
  <table id="stats-table">
    <thead><tr><th>Room</th><th>Type</th><th>Capacity</th><th>Occupants</th><th>Registered Time</th></tr></thead>
    <tbody></tbody>
  </table>
  <button class="back-btn" onclick="backToMain()">‚Üê Back to Main Page</button>
</div>

<!-- Modal -->
<div id="modal" class="modal">
  <div class="modal-panel">
    <h3 id="modalTitle">Room</h3>
    <div class="sub" id="modalSub">Details</div>
    <div class="occupant-list" id="occupantList"></div>
    <input id="nameInput" class="input" placeholder="Enter your name" autocomplete="off"/>
    <div class="row">
      <button class="btn register" id="registerBtn">Register</button>
      <button class="btn close" id="closeBtn">Close</button>
    </div>
  </div>
</div>

<script>
const STORAGE_KEY='arup_rooms_v8';
const ADMIN_PASS='0977549979';
let rooms=[],isAdmin=false,currentRoomIndex=null;

function loadRooms(){
  const raw=localStorage.getItem(STORAGE_KEY);
  if(raw){try{rooms=JSON.parse(raw);return;}catch(e){}}
  rooms=[];
  for(let i=1;i<=5;i++)rooms.push({name:`Single Room ${i}`,type:'single',max:1,people:[]});
  for(let i=1;i<=5;i++)rooms.push({name:`Double Room ${i}`,type:'double',max:2,people:[]});
  for(let i=1;i<=5;i++)rooms.push({name:`Triple Room ${i}`,type:'triple',max:3,people:[]});
  saveRooms();
}
function saveRooms(){localStorage.setItem(STORAGE_KEY,JSON.stringify(rooms));}
function getRoomsByType(t){return rooms.map((r,i)=>({...r,__idx:i})).filter(r=>r.type===t);}
function reindexNames(t){const b=t==='single'?'Single Room':t==='double'?'Double Room':'Triple Room';getRoomsByType(t).forEach((r,i)=>rooms[r.__idx].name=`${b} ${i+1}`);}

const gridSingle=document.getElementById('grid-single'),gridDouble=document.getElementById('grid-double'),gridTriple=document.getElementById('grid-triple'),totalInfo=document.getElementById('totalInfo');
function render(){
  gridSingle.innerHTML=gridDouble.innerHTML=gridTriple.innerHTML='';
  rooms.forEach((r,idx)=>{
    const card=document.createElement('div');
    card.className='room-card'+(r.people.length>=r.max?' locked':'');
    card.innerHTML=`<div class="room-icon">üö™</div>
    <div class="room-name">${r.name}</div>
    <div class="room-occupants">${r.people.length?r.people.map(p=>p.name).join('<br>'):'<i style="color:#aaa">No occupants</i>'}</div>
    <div style="margin-top:8px;font-size:12px;color:var(--muted)">${r.people.length}/${r.max} occupants</div>`;
    card.onclick=()=>{if(r.people.length>=r.max)return alert('This room is full.');openModal(idx);};
    if(r.type==='single')gridSingle.appendChild(card);
    else if(r.type==='double')gridDouble.appendChild(card);
    else gridTriple.appendChild(card);
  });
  const totalPeople=rooms.reduce((s,r)=>s+r.people.length,0);
  totalInfo.textContent=`Total: ${rooms.length} rooms ‚Ä¢ ${totalPeople} people`;
  document.querySelectorAll('.admin-only').forEach(b=>b.style.display=isAdmin?'inline-block':'none');
}

function addRoom(type){
  const base=type==='single'?'Single Room':type==='double'?'Double Room':'Triple Room';
  const c=getRoomsByType(type).length;
  const name=prompt('Enter new room name:',`${base} ${c+1}`);if(!name)return;
  const max=type==='single'?1:type==='double'?2:3;
  rooms.push({name,type,max,people:[]});saveRooms();render();
}
function removeRoom(type){if(!isAdmin)return alert('Admin only.');const list=getRoomsByType(type);if(!list.length)return alert('No rooms left.');const last=list.pop();if(!confirm(`Remove ${last.name}?`))return;rooms.splice(last.__idx,1);reindexNames(type);saveRooms();render();}
document.getElementById('single-add').onclick=()=>addRoom('single');
document.getElementById('double-add').onclick=()=>addRoom('double');
document.getElementById('triple-add').onclick=()=>addRoom('triple');
document.getElementById('single-remove').onclick=()=>removeRoom('single');
document.getElementById('double-remove').onclick=()=>removeRoom('double');
document.getElementById('triple-remove').onclick=()=>removeRoom('triple');

const modal=document.getElementById('modal'),modalTitle=document.getElementById('modalTitle'),modalSub=document.getElementById('modalSub'),occupantList=document.getElementById('occupantList'),nameInput=document.getElementById('nameInput');
function openModal(i){currentRoomIndex=i;const r=rooms[i];modalTitle.textContent=r.name;modalSub.textContent=`Capacity: ${r.max} ‚Ä¢ Registered: ${r.people.length}`;renderOccupants(r);modal.classList.add('open');}
function closeModal(){modal.classList.remove('open');}
function renderOccupants(r){
  occupantList.innerHTML='';if(!r.people.length){occupantList.innerHTML='<div class="occupant-item">No occupants yet</div>';return;}
  r.people.forEach((p,i)=>{const it=document.createElement('div');it.className='occupant-item';it.innerHTML=`<div>${p.name} <small style="color:#888">(${p.time})</small></div>`;const b=document.createElement('button');b.textContent='Remove';b.style.display=isAdmin?'inline-block':'none';b.onclick=()=>{if(confirm(`Remove ${p.name}?`)){r.people.splice(i,1);saveRooms();render();openModal(currentRoomIndex);}};it.appendChild(b);occupantList.appendChild(it);});
}
document.getElementById('registerBtn').onclick=()=>{
  if(currentRoomIndex===null)return;const name=nameInput.value.trim();if(!name)return alert('Enter a name.');
  const r=rooms[currentRoomIndex];if(r.people.length>=r.max)return alert('Room full.');
  const now=new Date().toLocaleString();r.people.push({name,time:now});saveRooms();render();closeModal();
};
document.getElementById('closeBtn').onclick=closeModal;modal.onclick=e=>{if(e.target===modal)closeModal();};

document.getElementById('openAdmin').onclick=promptAdmin;
document.getElementById('exportCsvBtn').onclick=()=>{if(!isAdmin)return alert('Admin only.');exportCSV();};
function promptAdmin(){const p=prompt('Enter admin password:');if(p===ADMIN_PASS){isAdmin=true;alert('Admin logged in.');render();showAdminMenu();}else alert('Wrong password.');}

function showAdminMenu(){
  const totalPeople=rooms.reduce((s,r)=>s+r.people.length,0);
  const totalRooms=rooms.length;
  const choice=prompt(`Admin Panel
Total Rooms: ${totalRooms}
Total People: ${totalPeople}

Options:
1 - Show Summary
2 - Delete Person
3 - Delete Room
4 - Reset Data
5 - Export CSV
6 - Open Statistics Page
Enter number:`);if(!choice)return;
  switch(choice){
    case'1':adminStats();break;
    case'2':adminDeletePerson();break;
    case'3':adminDeleteRoom();break;
    case'4':adminReset();break;
    case'5':exportCSV();break;
    case'6':openStatsPage();break;
  }
}
function adminStats(){alert('Single:'+getRoomsByType('single').length+' Double:'+getRoomsByType('double').length+' Triple:'+getRoomsByType('triple').length);}
function adminDeletePerson(){const n=prompt('Enter name to delete:');if(!n)return;rooms.forEach(r=>r.people=r.people.filter(p=>p.name!==n));saveRooms();render();}
function adminDeleteRoom(){const n=prompt('Enter exact room name:');if(!n)return;const i=rooms.findIndex(r=>r.name===n);if(i===-1)return alert('Not found');const t=rooms[i].type;rooms.splice(i,1);reindexNames(t);saveRooms();render();}
function adminReset(){if(!confirm('Reset all data?'))return;localStorage.removeItem(STORAGE_KEY);loadRooms();render();}
function exportCSV(){const rows=['Room,Type,Max,Count,Occupants,Time'];rooms.forEach(r=>{r.people.forEach(p=>rows.push(`${r.name},${r.type},${r.max},${r.people.length},"${p.name}","${p.time}"`));});const csv=rows.join('\n');const blob=new Blob([csv],{type:'text/csv'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='rooms_export.csv';a.click();}
function openStatsPage(){document.getElementById('main-page').style.display='none';document.getElementById('main-controls').style.display='none';const page=document.getElementById('stats-page');page.style.display='block';renderStatsTable();}
function renderStatsTable(){
  const tbody=document.querySelector('#stats-table tbody');tbody.innerHTML='';
  const summary=document.getElementById('stats-summary');
  const counts={single:getRoomsByType('single').length,double:getRoomsByType('double').length,triple:getRoomsByType('triple').length};
  const people={single:getRoomsByType('single').reduce((s,r)=>s+r.people.length,0),double:getRoomsByType('double').reduce((s,r)=>s+r.people.length,0),triple:getRoomsByType('triple').reduce((s,r)=>s+r.people.length,0)};
  summary.innerHTML=`<b>Single:</b> ${counts.single} rooms, ${people.single} people<br><b>Double:</b> ${counts.double} rooms, ${people.double} people<br><b>Triple:</b> ${counts.triple} rooms, ${people.triple} people`;
  rooms.forEach(r=>r.people.forEach(p=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${r.name}</td><td>${r.type}</td><td>${r.max}</td><td>${p.name}</td><td>${p.time}</td>`;
    tbody.appendChild(tr);
  }));
}
function backToMain(){document.getElementById('stats-page').style.display='none';document.getElementById('main-page').style.display='grid';document.getElementById('main-controls').style.display='flex';}
loadRooms();render();
</script>
</body>
</html>
